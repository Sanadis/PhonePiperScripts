{
  "vars": [
    {
      "name": "_screen_saver",
      "value": "0",
      "type": "TIMER",
      "modify":"VISIBLE",
      "display": "Screen Saver",
      "displayType":"SECONDS"
    },
    {
      "name": "_seconds",
      "value": "0",
      "type": "TIMER",
      "modify":"VISIBLE",
      "display": "Elapsed Time",
      "displayType":"SECONDS"
    },
    {
      "name": "_loops",
      "value": "0",
      "type": "TIMER",
      "modify":"VISIBLE",
      "display": "NoOp",
      "displayType":"SECONDS"
    }
  ],
  "states": {

    "main": {
      "name":"Common - Main Template",
      "includes": ["_common-power_down"]
    },

    "recovery": {
      "name":"Common - Recovery Template",
      "includes": ["_common-recovery_os"]
    },

    "log-in": {
      "name":"Common - Recovery Login Template",
      "includes": ["_common-power_down"]
    },

    "reset": {
      "name": "Common - Reset",
      "includes": [
        "_common-reset"
      ]
    },

    "_common-screen_saver": {
      "name":"Common - Screen Saver",
      "statements": [
        {
          "condition": {
            "var": "_screen_saver",
            "is": "GREATER",
            "value": "900"
          },
          "actions": [
            {
              "type": "SET",
              "value": "0",
              "var": "_screen_saver"
            },
            {
              "type": "MSG",
              "value": "Screen saver activated"
            },
            {
              "type": "EVENT",
              "value": "camera"
            },
            {
              "type": "WAIT",
              "value": "5000"
            },
            {
              "type": "EVENT",
              "value": "back"
            },
            {
              "type": "WAIT",
              "value": "15000"
            },
            {
              "type": "MSG",
              "value": "Returning"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        }
      ]
    },

    "_common-recovery_os": {
      "name":"Common - Power Device Down",
      "includes": ["_common-power_down"]
    },

    "_common-power_down": {
      "name": "Common - Power Down",
      "statements": [
        {
          "condition": {
            "is": "BOOLEAN",
            "value": "true"
          },
          "actions": [
            {
              "type": "MSG",
              "value": "Default operation stops operations and locks the device"
            },
            {
              "type": "EVENT",
              "value": "power"
            },
            {
              "type": "STOP"
            }
          ]
        }
      ]
    },

    "_common-no_op": {
      "name": "Common - No-Op",
      "statements": [
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-connection_error"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-connection_error-ok"
            },
            {
              "type": "WAIT",
              "value": "1500"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },{
          "condition": {
            "is": "SCREEN",
            "value": "menu-quest_restart"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-quest_restart-yes"
            },
            {
              "type": "WAIT",
              "value": "1500"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-connection_error_2"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-connection_error_2-ok"
            },
            {
              "type": "WAIT",
              "value": "1500"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-logo"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "screen-center"
            },
            {
              "type": "WAIT",
              "value": "1500"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-play_mission"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-play_mission-yes"
            },
            {
              "type": "WAIT",
              "value": "1500"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-daily-notice"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-daily-close"
            },
            {
              "type": "WAIT",
              "value": "1500"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "os-unable_to_access_data"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "os-unable_to_access_data-ok"
            },
            {
              "type": "WAIT",
              "value": "4000"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-energy_recovery"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-energy_recovery-back"
            },
            {
              "type": "WAIT",
              "value": "1500"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-companion_changed"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-companion_changed-ok"
            },
            {
              "type": "WAIT",
              "value": "1500"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "os-home"
          },
          "actions": [
            {
              "type": "MSG",
              "value": "Home screen detected, attempting recovery"
            },
            {
              "type": "MOVE",
              "value": "recovery"
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-log_in_again"
          },
          "actions": [
            {
              "type": "MSG",
              "value": "Log in Required"
            },
            {
              "type": "MOVE",
              "value": "log-in"
            }
          ]
        },
        {
          "condition": {
            "var": "_loops",
            "is": "GREATER",
            "value": "900"
          },
          "actions": [
            {
              "type": "MSG",
              "value": "Too many cycles, stopping run"
            },
            {
              "type": "STOP",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "var": "_loops",
            "is": "GREATER",
            "value": "45"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-level"
            }
          ]
        }
      ]
    },

    "_common-reset": {
      "name": "Common - Reset",
      "statements": [
        {
          "condition": {
            "is": "BOOLEAN",
            "value": "true"
          },
          "actions": [
            {
              "type": "SET",
              "value": "0",
              "var": "_loops"
            },{
              "type": "SET",
              "value": "0",
              "var": "_seconds"
            },{
              "type": "SET",
              "value": "0",
              "var": "_screen_saver"
            },
            {
              "type": "MOVE",
              "value": "main"
            }
          ]
        }
      ]
    }

  }
}