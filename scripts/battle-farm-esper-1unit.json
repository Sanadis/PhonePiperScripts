{
  "vars": [
    {
      "name": "lb",
      "value": "0",
      "type": "INT"
    },
    {
      "name": "esper",
      "value": "0",
      "type": "INT"
    },
    {
      "name": "runs",
      "value": "0",
      "type": "INT"
    }
  ],
  "includes": [
    "common-no_op",
    "common-menu_location",
    "common-menu_results"
  ],
  "states": {
    "main": {
      "name": "Main",
      "includes": [
        "_to-results",
        "_to-battle",
        "_to-menu",
        "_common-no_op"
      ]
    },

    "menu": {
      "name": "Menu",
      "includes": [
        "_common-ml-mission_2",
        "_common-ml-goals",
        "_common-ml-friend_last",
        "_common-ml-depart",
        "_to-battle",
        "_common-no_op"
      ]
    },

    "battle": {
      "name": "Battle",
      "includes": [
        "_to-results",
        "_common-no_op"
      ],
      "statements": [
        {
          "condition": {
            "is": "SCREEN",
            "value": "game-battle-repeat",
            "and": [
              {
                "is": "SCREEN",
                "value": "battle-unit-0_ready"
              },
              {
                "not": "SCREEN",
                "value": "battle-esper-notfull"
              }
            ]
          },
          "actions": [
            {
              "type": "MSG",
              "value": "Switch to Esper"
            },
            {
              "type": "LAP",
              "value": "ESPER"
            },
            {
              "type": "ADD",
              "var": "esper",
              "value": "1"
            },
            {
              "type": "SWAP",
              "value": "esper"
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "game-battle-repeat",
            "and": [
              {
                "is": "SCREEN",
                "value": "battle-unit-0_ready"
              },
              {
                "not": "SCREEN",
                "value": "battle-unit-0_notfull"
              }
            ]
          },
          "actions": [
            {
              "type": "MSG",
              "value": "Switch to LB"
            },
            {
              "type": "LAP",
              "value": "LB"
            },
            {
              "type": "ADD",
              "var": "lb",
              "value": "1"
            },
            {
              "type": "SWAP",
              "value": "lb"
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "game-battle-repeat",
            "and": [
              {
                "is": "SCREEN",
                "value": "battle-unit-0_ready"
              }
            ]
          },
          "actions": [
            {
              "type": "MSG",
              "value": "Unit Wait"
            },
            {
              "type": "BATCH",
              "value": "START"
            },
            {
              "type": "SWIPE_DOWN",
              "value": "battle-unit_0"
            },
            {
              "type": "TAP",
              "value": "battle-unit_0"
            },
            {
              "type": "BATCH",
              "value": "END"
            }
          ]
        }
      ]
    },

    "lb": {
      "name": "Limit Burst Release",
      "statements": [
        {
          "condition": {
            "is": "BOOLEAN",
            "value": "true"
          },
          "actions": [
            {
              "type": "SET",
              "value": "0",
              "var": "_loops"
            },
            {
              "type": "MSG",
              "value": "Unit 0 - LB (${lb})"
            },
            {
              "type": "BATCH",
              "value": "START"
            },
            {
              "type": "SWIPE_RIGHT",
              "value": "battle-unit_0"
            },
            {
              "type": "TAP",
              "value": "battle-unit_0"
            },
            {
              "type": "TAP",
              "value": "battle-unit_0"
            },
            {
              "type": "TAP",
              "value": "battle-unit_0"
            },
            {
              "type": "BATCH",
              "value": "END"
            }
          ]
        },
        {
          "condition": {
            "is": "BOOLEAN",
            "value": "true"
          },
          "actions": [
            {
              "type": "MSG",
              "value": "Move to Battle"
            },
            {
              "type": "WAIT",
              "value": "2000"
            },
            {
              "type": "MOVE",
              "value": "battle"
            }
          ]
        }
      ]
    },

    "esper": {
      "name": "Esper Release",
      "statements": [
        {
          "condition": {
            "is": "BOOLEAN",
            "value": "true"
          },
          "actions": [
            {
              "type": "SET",
              "value": "0",
              "var": "_loops"
            },
            {
              "type": "MSG",
              "value": "Unit 0 - Esper (${esper})"
            },
            {
              "type": "BATCH",
              "value": "START"
            },
            {
              "type": "SWIPE_RIGHT",
              "value": "battle-unit_0"
            },
            {
              "type": "TAP",
              "value": "battle-unit_3"
            },
            {
              "type": "TAP",
              "value": "battle-unit_0"
            },
            {
              "type": "TAP",
              "value": "battle-unit_0"
            },
            {
              "type": "BATCH",
              "value": "END"
            }
          ]
        },
        {
          "condition": {
            "is": "BOOLEAN",
            "value": "true"
          },
          "actions": [
            {
              "type": "MSG",
              "value": "Move to Battle"
            },
            {
              "type": "WAIT",
              "value": "2000"
            },
            {
              "type": "MOVE",
              "value": "battle"
            }
          ]
        }
      ]
    },

    "results": {
      "name": "Results",
      "includes": [
        "_common_mr-points",
        "_common_mr-units",
        "_common_mr-items",
        "_common_mr-friend_request",
        "_to-menu",
        "_common-no_op"
      ],
      "statements": [

      ]
    },

    "_to-menu": {
      "name": "To The Menu",
      "statements": [
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-missions-select",
            "or": [
              {
                "is": "SCREEN",
                "value": "menu-goal_list"
              }
            ]
          },
          "actions": [
            {
              "type": "MSG",
              "value": "Ending run ${runs}"
            },
            {
              "type": "MOVE",
              "value": "menu"
            }
          ]
        }
      ]
    },

    "_to-battle": {
      "name": "To The Battle",
      "statements": [
        {
          "condition": {
            "is": "SCREEN",
            "value": "game-battle"
          },
          "actions": [
            {
              "type": "LAP",
              "value": "BATTLE"
            },
            {
              "type": "SET",
              "var": "_loops",
              "value": "0"
            },
            {
              "type": "ADD",
              "var": "runs",
              "value": "1"
            },
            {
              "type": "MSG",
              "value": "Starting run ${runs}"
            },
            {
              "type": "SWAP",
              "value": "battle"
            }
          ]
        }
      ]
    },

    "_to-results": {
      "name": "To the Results",
      "statements": [
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-results-points"
          },
          "actions": [
            {
              "type": "SET",
              "var": "_loops",
              "value": "0"
            },
            {
              "type": "SWAP",
              "value": "results"
            }
          ]
        }
      ]
    }

  }
}