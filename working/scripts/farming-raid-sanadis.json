//@formatter:off
{
"vars": [],
"imports": [
//  "veritas",
//  "nichol",
  "lilith",
  "malphasie",
  "hyoh"
//  "xon"
],
"states": {

  "raid-battle": {
    "name": "Raid - Battle (Override)",
    "includes": [
      "_raid_battle-auto",
      "_raid-battle-message",
      "_raid-to_results",
      "_common-no_op"
    ]
  },

  "_raid_battle-auto": {
    "name": "Raid Battle - Auto (Override)",
    "variables": {
      "index_malphasie-break": {"value": "0", "type": "INT"},
      "index_lilith-imperil": {"value": "1", "type": "INT"},
      "index_lilith-chain": {"value": "2", "type": "INT"},
      "index_malphasie-chain": {"value": "3", "type": "INT"},
      "index_hyoh": {"value": "4", "type": "INT"},
      "turn": {"value": "1", "type": "INT"}
    },
    "statements": [{
      "condition": {
        "is": "SCREEN", "value" : "game-battle",
        "and": [{
          "var": "_loops", "is": "GREATER", "value": "120"}
        ]
      },
      "actions": [{
        "type": "INFO", "value": "Force Attacking - Pause Detected (Turn: ${turn})"}, {
        "type": "SET", "var": "_loops", "value": "0"}, {
        "type": "BATCH", "value": "start"}, {
        "type": "TAP", "value": "battle-unit_0"}, {
        "type": "TAP", "value": "battle-unit_1"}, {
        "type": "TAP", "value": "battle-unit_2"}, {
        "type": "TAP", "value": "battle-unit_3"}, {
        "type": "TAP", "value": "battle-unit_4"}, {
        "type": "TAP", "value": "battle-unit_5"}, {
        "type": "BATCH", "value": "end"}, {
        "type": "WAIT", "value": "2000"}, {
        "type": "ADD", "value": "1", "var": "turn"}, {
        "type": "REPEAT", "value": ""}
      ]

    }, {

      "condition": {
        "is": "CALL", "value": "@isBattleReady",
        "and": [{
          "is": "CALL", "value": "@isUnitReady", "args": {"index": "${index_malphasie-break}"} }, {
          "is": "CALL", "value": "@isUnitMpReady", "args": {"index": "${index_malphasie-break}"} }, {
          "not": "CALL", "value": "@isUnitActionReady", "args": {"index": "${index_malphasie-break}"} }
        ]
      },
      "actions": [{
        "type": "CALL", "value": "@malphasie-feather", "args": {"index": "${index_malphasie-break}"}}, {
        "type": "REPEAT"}
      ]
    }, {
      "condition": {
        "is": "CALL", "value": "@isBattleReady",
        "and": [{
          "is": "CALL", "value": "@isUnitReady", "args": {"index": "${index_lilith-imperil}"} }, {
          "is": "CALL", "value": "@isUnitMpReady", "args": {"index": "${index_lilith-imperil}"} }, {
          "not": "CALL", "value": "@isUnitActionReady", "args": {"index": "${index_lilith-imperil}"} }
        ]
      },
      "actions": [{
        "type": "CALL", "value": "@lilith-midnight-imperil", "args": {"index": "${index_lilith-imperil}"}}, {
        "type": "REPEAT"}
      ]

    }, {

      "condition": {
        "is": "CALL", "value": "@isBattleReady",
        "and": [{
          "is": "CALL", "value": "@isUnitReady", "args": {"index": "${index_lilith-chain}"} }, {
          "is": "CALL", "value": "@isUnitMpReady", "args": {"index": "${index_lilith-chain}"} }, {
          "not": "CALL", "value": "@isUnitActionReady", "args": {"index": "${index_lilith-chain}"} }
        ]
      },
      "actions": [{
        "type": "CALL", "value": "@lilith-midnight", "args": {"index": "${index_lilith-chain}"}}, {
        "type": "REPEAT"}
      ]
    }, {

      "condition": {
        "is": "CALL", "value": "@isBattleReady",
        "and": [{
          "is": "CALL", "value": "@isUnitReady", "args": {"index": "${index_malphasie-chain}"} }, {
          "is": "CALL", "value": "@isUnitMpReady", "args": {"index": "${index_malphasie-chain}"} }, {
          "not": "CALL", "value": "@isUnitActionReady", "args": {"index": "${index_malphasie-chain}"} }
        ]
      },
      "actions": [{
        "type": "CALL", "value": "@malphasie-fiendishwinds", "args": {"index": "${index_malphasie-chain}"}}, {
        "type": "REPEAT"}
      ]
    }, {

      "condition": {
        "is": "CALL", "value": "@isBattleReady",
        "and": [{
          "is": "CALL", "value": "@isUnitReady", "args": {"index": "${index_hyoh}"} }, {
          "is": "CALL", "value": "@isUnitMpReady", "args": {"index": "${index_hyoh}"} }, {
          "not": "CALL", "value": "@isUnitActionReady", "args": {"index": "${index_hyoh}"} }
        ]
      },
      "actions": [{
        "type": "CALL", "value": "@hyoh-servant", "args": {"index": "${index_hyoh}"}}, {
        "type": "REPEAT"}
      ]
    }, {

      "condition": {
        "is": "SCREEN", "value": "game-battle-repeat",
        "and": [{
          "is": "CALL", "value": "@isUnitActionReady", "args": {"index": "${index_malphasie-chain}"} }, {
          "is": "CALL", "value": "@isUnitActionReady", "args": {"index": "${index_lilith-chain}"} }, {
          "is": "CALL", "value": "@isUnitActionReady", "args": {"index": "${index_hyoh}"} }
        ]
      },
      "actions": [{
        "type": "INFO", "value": "Attack ${turn}"}, {
        "type": "CALL", "value": "@tapUnit", "args": {"index": "${index_malphasie-break}"}}, {
        "type": "WAIT", "value": "500"}, {
        "type": "CALL", "value": "@tapUnit", "args": {"index": "${index_lilith-imperil}"}}, {
        "type": "WAIT", "value": "100"}, {
        "type": "BATCH", "value": "start"}, {
        "type": "CALL", "value": "@tapUnit", "args": {"index": "${index_lilith-chain}"}}, {
        "type": "CALL", "value": "@tapUnit", "args": {"index": "${index_malphasie-chain}"}}, {
        "type": "CALL", "value": "@tapUnit", "args": {"index": "${index_hyoh}"}}, {
        "type": "BATCH", "value": "end"}, {
        "type": "WAIT", "value": "2000"}, {
        "type": "CALL", "value": "@tapUnit", "args": {"index": "5"}}, {
        "type": "WAIT", "value": "2000"}, {
        "type": "ADD", "value": "1", "var": "turn"}, {
        "type": "CALL", "value": "@keepAlive"}, {
        "type": "REPEAT"}
      ]
    }, {

      "condition": {
         "is": "SCREEN", "value": "battle-actions_back"
       },
       "actions": [{
         "type": "INFO", "value": "Backing up, stuck on skill screen"}, {
         "type": "TAP", "value": "battle-actions-back"}, {
         "type": "REPEAT", "value": ""}
       ]

    }, {

      "condition": {
        "is": "SCREEN", "value": "game-battle",
        "and": [{
          "not": "SCREEN", "value": "game-battle-auto_off"
        }]
      },
      "actions": [{
        "type": "SET", "value": "0", "var": "_loops"}
      ]
    }]

  }
}
}